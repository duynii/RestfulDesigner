<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Tutorial: Hello Dojo!</title>
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/dojo/1.8/dijit/themes/claro/claro.css" media="screen">
    <link rel="stylesheet" href="stylesheet/style.css" media="screen">
</head>
<body class="claro">
    <div id="appLayout" 
        style="width: 1280px; height:800px"
        data-dojo-type="dijit/layout/BorderContainer"
        data-dojo-props="design: 'headline'">
<!-- Top section -->
        <div id="topArea" style="height: 60%;"
        data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region: 'top', splitter: true">
            <!-- Top Region -->
            <div id="topTab"
                    data-dojo-type="dijit/layout/TabContainer"
                    data-dojo-props="region: 'center', tabPosition: 'bottom'">
                <div
                        data-dojo-type="dijit/layout/ContentPane"
                        data-dojo-props="title: 'Group Two'">
                    <h4>Group 2 Content</h4>
                    <ol id="resourcesList">
                        <li>
                            <label name="_root" class="rootButton">  /   </label>
                        </li>
                        <li>
                            <button name="_root" class="hidden">      </button>
                            <button id="id_static_1"    name="_public"      class="staticResource">public/</button>
                            <button id="id_hospitals"   name="_hospitals"   class="collectionResource">{hospitals}/</button>
                            <button id="id_hospital"    name="_hospital"    class="individualResource">{hospital}/</button>
                            <button name="_hospital_address" class="partialResource">address/</button>
                            <button id="_add1" class="addButton" name="_add"> + </button>
                        </li>
                        <li>
                            <button disabled="disabled" name="_root" class="hidden">      </button>
                            <button disabled="disabled" name="_public"     class="hidden staticResource">public/</button>
                            <button disabled="disabled" name="_hospitals"  class="hidden collectionResource">{hospitals}/</button>
                            <button disabled="disabled" name="_hospital"   class="hidden individualResource">{hospital}/</button>
                            <button id="templatedButton" data-dojo-type="rfd/widget/CollectionButton" />
                            <button class="collectionResource" name="_services">{services}/</button>
                            <button id="_add" class="addButton" name="_add"> + </button>
                        </li>
                        <li>
                            <button disabled="disabled" name="_root" class="hidden">      </button>
                            <button disabled="disabled" name="_public"      class="hidden staticResource">public/</button>
                            <button disabled="disabled" name="_hospitals"   class="hidden collectionResource">{hospitals}/</button>
                            <button enabled="enabled" class="customResource" name="_find_nearest">find_nearest/</button>
                            <button id="_add" class="addButton" name="_add"> + </button>
                        </li>
                        <li>
                            <label id="authorWidget" data-dojo-type="rfd/widget/AuthorWidget">blah</label>
                        </li>
                        <li data-dojo-type="rfd/widget/ListItem" />
                    </ol>
                </div>
                <div
                        data-dojo-type="dijit/layout/ContentPane"
                        data-dojo-props="title: 'Group 1'">
                    <div id='rootPlacement'>
                       <button id='root' data-dojo-type="dijit/form/Button">Click Me</button>
                       <button id="rootPlus" class="addButton" data-dojo-type="dijit/form/Button"> + </button>
                    </div>
                    <div>
                       <button data-dojo-type="dijit/form/Button">Click Me</button>
                       <button class="addButton" data-dojo-type="dijit/form/Button"> + </button>
                    </div>
                    <h4>Group 1 Content</h4>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incidid.</p>
                    <button data-dojo-type="rfd/Button"></button>
                </div>
                <div
                        data-dojo-type="dijit/layout/ContentPane"
                        data-dojo-props="title: 'Long Tab Label for this One'">
                    <h4>Group 3 Content</h4>
                </div>
            </div>
        </div>
<!-- Bottom section -->
        <div id="bottomArea" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region: 'center'">
            <!-- Outter center region -->
            <div id="bottom"
                    style="width: 1280px; height: 40%; margin: 0; padding: 0"
                    data-dojo-type="dijit/layout/BorderContainer" data-dojo-props="design: 'headline'">
                <div id="bottomLeft" style="width: 100%"
                    data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region: 'left'">
                    Bottom Left
                    <table id="classT" >
                        <tr><td>row 1</td></tr>
                    </table>
                        <table id="classTable"  class="classTable"/>
                        <table id="classTemp" class="classTable"/>

                </div>
            </div>
        </div>
    </div>
    <!-- load Dojo -->
    <script>
        dojoConfig = {
            has: {
            "dojo-firebug": true
            },
            parseOnLoad: true,
            async: true,
            baseUrl: "/RfD/",
            tlmSiblingOfDojo: false,
            packages: [
                { name: "dojo", location: "dojo" },
                { name: "dijit", location: "dijit" },
                { name: "dojox", location: "dojox" },
                { name: "Button", location: "rfd" },
                { name: "Resource", location: "rfd" },
                { name: "StaticResource", location: "rfd" },
                { name: "TemplatedResource", location: "rfd" },
                { name: "ConceptResource", location: "rfd" },
                { name: "Concept_R", location: "rfd" }
            ]
        };
    </script>
<script src="../dojo/dojo.js"></script>

<!-- Start of code -->
    <script>
        require([ "dojo/parser", 
                  "dijit/form/Button",
                  "dijit/registry",
                  "dojo/dom",
                  "dojo/ready",
                  "dojo/query",
                  "dojo/on",
                  "dojo/dom-construct",
                  "dojo/dom-style",
                  "dojo/dnd/Selector",
                  "dojo/dnd/Container",
                  "dojo/dnd/Target",
                  "dojo/dnd/Moveable",
                  "rfd/Resource",
                  "rfd/StaticResource",
                  "rfd/TemplatedResource",
                  "rfd/ConceptResource",
                  "rfd/Representation",
                  "rfd/Concept_R",
                    //Widgets
                  "dijit/form/Button",
                  "dijit/form/DropDownButton",
                  "dijit/TooltipDialog",
                  "dijit/popup",
                    // Layout
                  "dojo/domReady",
                  "dijit/layout/BorderContainer", 
                  "dijit/layout/TabContainer", 
                  "dijit/layout/ContentPane" ], function(parser, Button, registry, dom, ready, query, on,
                                                         domConstruct, domStyle,
                                                         Selector, Container, Target, Moveable,
                                                         Resource, StaticResource, TemplatedResource, ConceptResource, Representation,
                                                         Concept_R,
                                                         Button, DropDownButton, TooltipDialog, popup
                                                        ) {
                ready(function() 
                { 
                    parser.parse();
                    
                    // Buttons and TooltipDialog
                    var tooltip = new TooltipDialog({
                        id: 'id_tooltip',
                        style: "width: 300px;",
                        content: "<p>I have a mouse leave event handler that will close the dialog.</p>",
                        onMouseLeave: function(){
                            popup.close(tooltip);
                        }
                    });
            
                    //Register event with dom node

    on(dom.byId('id_hospitals'), 'mouseover', function(){
        popup.open({
            popup: tooltip,
            around: dom.byId('id_hospitals')
        });
    });
            
                    var dropButton = new Button({
                            dropDown: tooltip,
                            baseClass: "button collectionResource",
                            label: "{hospital}"
                        },
                        "id_hospital"
                    );

                    console.log("Button base class: " + dropButton.baseClass);
                    //var w_hospitals = registry.byId("id_hospitals);
//                    var b_hospitals = new Button({
//                        onClick: function(event) {
//                            alert("clicked hospitals");
//                        }},
//                        "id_hospitals"
//                    );

                    var cRes = new Concept_R('CResource');
                    console.log("Concept_R " + cRes.toString());
                    var tempButton = registry.byId("templatedButton");
                    tempButton.set("concept", cRes);

/*
                    var resource = new StaticResource('root');
                    console.log("Resource: " + resource.toString() + "\n");

                    var templateR = new TemplatedResource('tempR', { "title" : "Castle", "series" : "4", "episode" : "40" },
                                                          null);
                    console.log('static resource: ' + templateR.toString()); 

                    var concept = new ConceptResource('test');
                    console.log('Concept resource: ' + concept.toString()); 
                    var rep = new Representation(concept);
                    rep.addField({ "name" : "Royal Children Hospital", "type": "Single String"});     
                    rep.addField({ "phone" : "0295556789", "type": "Integer"});     

                    console.log("representation test = " + rep.toString());

                    var cRes = new Concept_R('CResource');
                    console.log("Concept_R " + cRes.toString());
                             

                    var wid = registry.byId("rootPlus");
                    if(wid) {
                        wid.set("p_data", "root");
                    }

                    registry.byId("root").set("label", "/").set("disabled", "disabled");

                    query(".addButton").forEach(function(node, index, nodelist){
                        console.info("Registering add button event..." + node.p_data);
                        // for each node in the array returned by query,
                        // execute the following code
                        on(node, "click", function(evt) 
                        {
                            var widget = registry.getEnclosingWidget(evt.target);
                            if(widget){
                                console.log("click on widget " + widget.id + " " + widget.p_data);
                            }
                        });
                    });
*/

                    var table = dojo.byId("classTable");
                    domConstruct.create("th", { innerHTML: "Hospital" }, table);
            
                    var bottomArea = dojo.byId("bottomLeft");
    
                    var clUI = new Container(table, { creator: function(item, hint) {
                        var tr = domConstruct.create("tr");
                        var td = domConstruct.create("td", { innerHTML: item}, tr);
                        return { node: tr, data: item, type: ["text"] };
                    } });
                    clUI.insertNodes([ "id: string", "name: string", "fax: string" ], false, null);
                    
                    var table2 = dojo.byId("classTemp");
                    domConstruct.create("th", { innerHTML: "Services" }, table2);
                    var clUI2 = new Container(table2, { creator: function(item, hint) {
                        var tr = domConstruct.create("tr");
                        var td = domConstruct.create("td", { innerHTML: item}, tr);
                        return { node: tr, data: item, type: ["text"] };
                    } });
                    clUI2.insertNodes([ "id: string", "name: string", "fax: string" ], false, null);

                    var move = new Moveable("classT");
                    var span = new Moveable("classTable");
                    var span2 = new Moveable("classTemp");
              });
            });
    </script>
</body>
</html>
